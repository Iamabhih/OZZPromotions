<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>July 2025 Promotional Catalog</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide-react/0.263.1/lucide-react.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸŽ‰</text></svg>">
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { Search, Filter, Grid, List, ShoppingCart, Eye, X } = lucide;

        const ProductCatalog = () => {
          const [products, setProducts] = useState([]);
          const [loading, setLoading] = useState(true);
          const [searchTerm, setSearchTerm] = useState('');
          const [selectedCategory, setSelectedCategory] = useState('ALL');
          const [viewMode, setViewMode] = useState('grid');
          const [selectedProduct, setSelectedProduct] = useState(null);
          const [sortBy, setSortBy] = useState('name');
          const [sortOrder, setSortOrder] = useState('asc');

          // Load products from Excel data
          useEffect(() => {
            const loadProducts = async () => {
              try {
                // Try to read Excel file
                let cleanedProducts = [];
                
                try {
                  const response = await fetch('./JULY PROMO.xlsx');
                  const arrayBuffer = await response.arrayBuffer();
                  const workbook = XLSX.read(arrayBuffer);
                  const worksheet = workbook.Sheets['Sheet1'];
                  const rawData = XLSX.utils.sheet_to_json(worksheet);
                  
                  // Clean and categorize products
                  cleanedProducts = rawData
                    .filter(item => item.SKU && item['PAGE 1'] && item.PRICE !== undefined)
                    .map(item => {
                      const description = item['PAGE 1'];
                      let category = 'OTHER';
                      
                      // Enhanced categorization logic
                      const desc = description.toUpperCase();
                      if (desc.includes('BOWL')) category = 'BOWLS';
                      else if (desc.includes('CUP') || desc.includes('MUG')) category = 'CUPS & MUGS';
                      else if (desc.includes('PLATE') || desc.includes('DINNER')) category = 'PLATES';
                      else if (desc.includes('GLASS') || desc.includes('WATER') || desc.includes('WINE') || 
                               desc.includes('TUMBLER') || desc.includes('CARAFFE') || desc.includes('CARAFE')) category = 'GLASSWARE';
                      else if (desc.includes('ICE CREAM') || desc.includes('GELATO')) category = 'ICE CREAM SETS';
                      else if (desc.includes('TRAY') || desc.includes('PLATTER')) category = 'TRAYS & PLATTERS';
                      else if (desc.includes('STORAGE') || desc.includes('CONTAINER') || desc.includes('CONT')) category = 'STORAGE';
                      else if (desc.includes('KITCHEN') || desc.includes('COOK') || desc.includes('UTENSIL')) category = 'KITCHEN TOOLS';
                      else if (desc.includes('CUTLERY') || desc.includes('KNIFE') || desc.includes('FORK') || desc.includes('SPOON')) category = 'CUTLERY';
                      else if (desc.includes('NAPKIN') || desc.includes('SERVIETTE') || desc.includes('TISSUE')) category = 'NAPKINS & PAPER';
                      else if (desc.includes('CANDLE') || desc.includes('LIGHTER')) category = 'CANDLES & LIGHTERS';
                      else if (desc.includes('BOTTLE') || desc.includes('JUG') || desc.includes('PITCHER')) category = 'BOTTLES & JUGS';
                      else if (desc.includes('FOIL') || desc.includes('WRAP') || desc.includes('BAG')) category = 'PACKAGING';
                      else if (desc.includes('TABLECLOTH') || desc.includes('TABLE CLOTH')) category = 'TABLE LINENS';
                      
                      return {
                        sku: item.SKU.toString(),
                        description: description,
                        price: parseFloat(item.PRICE),
                        category: category,
                        image: `https://via.placeholder.com/300x300/e2e8f0/64748b?text=${item.SKU}`
                      };
                    });
                    
                } catch (fileError) {
                  console.warn('Could not read Excel file, using sample data:', fileError);
                  
                  // Fallback sample data for demonstration
                  cleanedProducts = [
                    {sku: "455641", description: "BOWL SET 2PC STACK 6.7\" MAXIM", price: 25.95, category: "BOWLS", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455641"},
                    {sku: "455642", description: "BOWL SET 3PC 4.4\" MAXIM", price: 20.95, category: "BOWLS", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455642"},
                    {sku: "455639", description: "BOWL SET 6PC STACK 3.6\" MAXIM", price: 24.95, category: "BOWLS", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455639"},
                    {sku: "455650", description: "BOWL SET 6PCE TULIP MAXIM", price: 28.95, category: "BOWLS", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455650"},
                    {sku: "455644", description: "BOWL SET 7PCE CASCARA MAXIM", price: 55.95, category: "BOWLS", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455644"},
                    {sku: "455643", description: "BOWL SET 7PCE CHRYSAN MAXIM", price: 55.95, category: "BOWLS", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455643"},
                    {sku: "455640", description: "ICE CREAM SET 3'S CLEAR MAXIM", price: 24.95, category: "ICE CREAM SETS", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455640"},
                    {sku: "455649", description: "ICE CREAM SET 3PC AGAPANT MAX", price: 24.95, category: "ICE CREAM SETS", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455649"},
                    {sku: "455634", description: "WATER SET 7PCE MAX BORBOLETA", price: 86.95, category: "GLASSWARE", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455634"},
                    {sku: "455636", description: "WATER SET 7PCE MAX CILON", price: 86.95, category: "GLASSWARE", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455636"},
                    {sku: "455647", description: "MUG BEER 3PCE VERNON 380ML MAX", price: 43.95, category: "CUPS & MUGS", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455647"},
                    {sku: "455648", description: "MUG COFFEE 4'S 250ML MAXIM", price: 31.95, category: "CUPS & MUGS", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455648"},
                    {sku: "444984", description: "PLATE 9 CLEAR PLAIN PP-9D", price: 9.95, category: "PLATES", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=444984"},
                    {sku: "4161", description: "PLATE DINNER H/P 10.5", price: 9.95, category: "PLATES", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=4161"},
                    {sku: "455080", description: "STORAGE CONT+LID 3PC REC 70923", price: 79.95, category: "STORAGE", image: "https://via.placeholder.com/300x300/e2e8f0/64748b?text=455080"}
                  ];
                }

                console.log(`Loaded ${cleanedProducts.length} products`);
                setProducts(cleanedProducts);
                setLoading(false);
              } catch (error) {
                console.error('Error loading products:', error);
                setLoading(false);
              }
            };

            loadProducts();
          }, []);

          // Get unique categories
          const categories = useMemo(() => {
            const cats = [...new Set(products.map(p => p.category))].sort();
            return ['ALL', ...cats];
          }, [products]);

          // Filter and sort products
          const filteredProducts = useMemo(() => {
            let filtered = products.filter(product => {
              const matchesSearch = product.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                   product.sku.includes(searchTerm);
              const matchesCategory = selectedCategory === 'ALL' || product.category === selectedCategory;
              return matchesSearch && matchesCategory;
            });

            // Sort products
            filtered.sort((a, b) => {
              let aVal, bVal;
              
              switch (sortBy) {
                case 'price':
                  aVal = a.price;
                  bVal = b.price;
                  break;
                case 'sku':
                  aVal = a.sku;
                  bVal = b.sku;
                  break;
                default:
                  aVal = a.description;
                  bVal = b.description;
              }

              if (typeof aVal === 'string') {
                aVal = aVal.toLowerCase();
                bVal = bVal.toLowerCase();
              }

              if (sortOrder === 'asc') {
                return aVal < bVal ? -1 : aVal > bVal ? 1 : 0;
              } else {
                return aVal > bVal ? -1 : aVal < bVal ? 1 : 0;
              }
            });

            return filtered;
          }, [products, searchTerm, selectedCategory, sortBy, sortOrder]);

          const ProductCard = ({ product }) => (
            React.createElement('div', { className: "bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 border-2 border-transparent hover:border-red-200" },
              React.createElement('div', { className: "relative" },
                React.createElement('img', { 
                  src: product.image, 
                  alt: product.description,
                  className: "w-full h-48 object-cover"
                }),
                React.createElement('div', { className: "absolute top-2 left-2 bg-red-500 text-white px-3 py-1 rounded-full text-xs font-bold" }, "PROMO"),
                React.createElement('button', {
                  onClick: () => setSelectedProduct(product),
                  className: "absolute top-2 right-2 bg-white p-2 rounded-full shadow-md hover:bg-red-50 transition-colors"
                }, React.createElement(Eye, { className: "w-4 h-4 text-red-600" }))
              ),
              React.createElement('div', { className: "p-4" },
                React.createElement('div', { className: "text-sm text-gray-500 mb-1" }, `SKU: ${product.sku}`),
                React.createElement('h3', { className: "font-semibold text-gray-900 mb-3 line-clamp-2 min-h-[3rem]" }, product.description),
                React.createElement('div', { className: "flex justify-between items-center mb-3" },
                  React.createElement('div', { className: "flex flex-col" },
                    React.createElement('span', { className: "text-2xl font-bold text-red-600" }, `$${product.price.toFixed(2)}`),
                    React.createElement('span', { className: "text-xs text-gray-400 line-through" }, `$${(product.price * 1.2).toFixed(2)}`)
                  ),
                  React.createElement('span', { className: "text-xs bg-gradient-to-r from-blue-500 to-red-500 text-white px-3 py-1 rounded-full font-semibold" }, product.category)
                ),
                React.createElement('button', {
                  onClick: () => setSelectedProduct(product),
                  className: "w-full bg-gradient-to-r from-red-500 to-red-600 text-white py-2 px-4 rounded-lg hover:from-red-600 hover:to-red-700 transition-all duration-200 font-semibold text-sm"
                }, "View Details")
              )
            )
          );

          if (loading) {
            return (
              React.createElement('div', { className: "min-h-screen bg-gray-50 flex items-center justify-center" },
                React.createElement('div', { className: "text-center" },
                  React.createElement('div', { className: "animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto" }),
                  React.createElement('p', { className: "mt-4 text-gray-600" }, "Loading catalog...")
                )
              )
            );
          }

          return (
            React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-red-50 via-white to-blue-50" },
              // Header
              React.createElement('header', { className: "bg-gradient-to-r from-red-600 via-red-500 to-blue-600 text-white shadow-lg" },
                React.createElement('div', { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" },
                  React.createElement('div', { className: "text-center" },
                    React.createElement('div', { className: "inline-block bg-white/20 backdrop-blur-sm rounded-full px-6 py-2 mb-4" },
                      React.createElement('span', { className: "text-sm font-semibold uppercase tracking-wide" }, "Special Promotion")
                    ),
                    React.createElement('h1', { className: "text-4xl md:text-5xl font-bold mb-2" }, "ðŸŽ‰ JULY 2025 PROMO ðŸŽ‰"),
                    React.createElement('p', { className: "text-xl mb-4" }, "Exclusive Deals on Premium Home & Kitchen Products"),
                    React.createElement('p', { className: "text-lg opacity-90" }, `${products.length} promotional items available`),
                    React.createElement('div', { className: "mt-6 inline-block bg-yellow-400 text-red-800 px-6 py-3 rounded-full font-bold text-lg shadow-lg animate-pulse" }, "LIMITED TIME OFFER!")
                  )
                )
              ),
              
              // Products Grid
              React.createElement('div', { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6" },
                viewMode === 'grid' ? 
                  React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6" },
                    filteredProducts.map(product => React.createElement(ProductCard, { key: product.sku, product: product }))
                  ) : null
              )
            )
          );
        };

        ReactDOM.render(React.createElement(ProductCatalog), document.getElementById('root'));
    </script>
</body>
</html>
