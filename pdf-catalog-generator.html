<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OZZ Professional Catalog</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background: #f0f2f5;
            color: #1a1a1a;
            line-height: 1.4;
        }
        
        /* Control Panel */
        .control-panel {
            max-width: 900px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
        }
        
        .logo-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .logo-header h1 {
            font-size: 32px;
            color: #1a1a1a;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        .logo-header p {
            color: #666;
            margin-top: 5px;
        }
        
        .button-group {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        button {
            background: #1a1a1a;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            background: #333;
            transform: translateY(-1px);
        }
        
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .status-box {
            background: #f8f9fa;
            border-left: 4px solid #0066cc;
            padding: 15px 20px;
            border-radius: 4px;
            margin: 20px 0;
        }
        
        .category-section {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .category-section h3 {
            margin-bottom: 15px;
            color: #1a1a1a;
        }
        
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .category-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: white;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .category-item:hover {
            background: #e9ecef;
        }
        
        .category-count {
            font-size: 12px;
            color: #666;
            margin-left: auto;
        }
        
        /* Print Preview Container */
        .print-preview {
            max-width: 210mm;
            margin: 20px auto;
        }
        
        /* Print Styles */
        @media print {
            body {
                margin: 0;
                padding: 0;
                background: white;
            }
            
            .control-panel {
                display: none;
            }
            
            .page {
                width: 210mm;
                height: 297mm;
                margin: 0;
                padding: 0;
                page-break-after: always;
                page-break-inside: avoid;
                position: relative;
                background: white;
                overflow: hidden;
            }
            
            .page:last-child {
                page-break-after: avoid;
            }
            
            /* Page Layout Structure */
            .page-inner {
                position: absolute;
                top: 15mm;
                left: 15mm;
                right: 15mm;
                bottom: 15mm;
                display: flex;
                flex-direction: column;
            }
            
            /* Page Header */
            .page-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding-bottom: 3mm;
                margin-bottom: 3mm;
                border-bottom: 2px solid #1a1a1a;
                flex-shrink: 0;
            }
            
            .header-left {
                display: flex;
                align-items: center;
                gap: 3mm;
            }
            
            .header-logo {
                height: 8mm;
                width: auto;
            }
            
            .header-title {
                font-size: 12pt;
                font-weight: 700;
                color: #1a1a1a;
            }
            
            .page-number {
                font-size: 10pt;
                color: #666;
                font-weight: 500;
            }
            
            /* Main Content Area */
            .page-content {
                flex: 1;
                display: flex;
                flex-direction: column;
                min-height: 0;
                margin-bottom: 5mm;
            }
            
            /* Category Header - Premium Style */
            .category-header {
                background: linear-gradient(90deg, #1a1a1a 0%, #2d2d2d 100%);
                color: white;
                padding: 4mm 6mm;
                margin: 0 -5mm 5mm -5mm;
                font-size: 14pt;
                font-weight: 800;
                letter-spacing: 1px;
                text-transform: uppercase;
                flex-shrink: 0;
                display: flex;
                align-items: center;
                box-shadow: 0 1mm 3mm rgba(0,0,0,0.15);
            }
            
            .category-header::before {
                content: '';
                width: 4mm;
                height: 4mm;
                background: #cc0000;
                margin-right: 4mm;
                display: block;
            }
            
            /* Products Grid Container */
            .products-container {
                flex: 1;
                min-height: 0;
                display: flex;
                align-items: flex-start;
            }
            
            /* Products Grid */
            .products-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                grid-template-rows: repeat(4, 1fr);
                gap: 4mm;
                width: 100%;
                height: 100%;
            }
            
            /* Product Card - High-End Retail Style */
            .product-card {
                background: white;
                display: flex;
                overflow: hidden;
                height: 100%;
                border-radius: 2mm;
                box-shadow: 0 0.5mm 2mm rgba(0,0,0,0.08);
            }
            
            /* Product Image - Left Side */
            .product-image {
                width: 40%;
                background: #fafafa;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 3mm;
                position: relative;
            }
            
            .product-image img {
                max-width: 100%;
                max-height: 100%;
                object-fit: contain;
                filter: drop-shadow(0 1mm 2mm rgba(0,0,0,0.1));
            }
            
            .no-image {
                text-align: center;
                color: #ddd;
            }
            
            .no-image-icon {
                font-size: 24pt;
                margin-bottom: 2mm;
            }
            
            .no-image-text {
                font-size: 7pt;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                color: #bbb;
            }
            
            /* Product Details - Right Side */
            .product-details {
                flex: 1;
                display: flex;
                flex-direction: column;
                overflow: hidden;
            }
            
            /* Product Header - Dark Teal */
            .product-header {
                background: #006b6b;
                color: white;
                padding: 2.5mm 3mm;
            }
            
            .product-name {
                font-size: 9pt;
                font-weight: 800;
                text-transform: uppercase;
                letter-spacing: 0.3px;
                line-height: 1.1;
                margin-bottom: 1mm;
            }
            
            .product-variant {
                font-size: 7pt;
                font-weight: 400;
                opacity: 0.85;
                text-transform: uppercase;
                letter-spacing: 0.2px;
            }
            
            /* Product Specs - Middle Section */
            .product-specs {
                background: white;
                padding: 3mm;
                flex: 1;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
            
            .spec-item {
                font-size: 7.5pt;
                color: #333;
                margin-bottom: 1.5mm;
                display: flex;
                align-items: baseline;
                line-height: 1.2;
            }
            
            .spec-item:last-child {
                margin-bottom: 0;
            }
            
            .spec-bullet {
                color: #006b6b;
                font-size: 9pt;
                margin-right: 2mm;
                line-height: 1;
            }
            
            .spec-label {
                font-weight: 600;
                color: #666;
                margin-right: 1mm;
                min-width: 12mm;
            }
            
            .spec-value {
                color: #1a1a1a;
            }
            
            /* Price Badge - Red Background */
            .price-badge {
                background: #cc0000;
                color: white;
                padding: 3mm;
                text-align: center;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
            }
            
            .price-amount {
                font-size: 16pt;
                font-weight: 800;
                line-height: 1;
                letter-spacing: -0.5px;
                margin-bottom: 1mm;
            }
            
            .price-currency {
                font-size: 11pt;
                font-weight: 700;
            }
            
            .price-cents {
                font-size: 9pt;
                vertical-align: super;
                font-weight: 700;
                margin-left: 0.5mm;
            }
            
            .price-unit {
                font-size: 7pt;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                opacity: 0.9;
                font-weight: 500;
            }
            
            /* Page Footer */
            .page-footer {
                border-top: 1px solid #e0e0e0;
                padding-top: 3mm;
                font-size: 7pt;
                color: #666;
                line-height: 1.4;
                flex-shrink: 0;
            }
            
            .disclaimer {
                margin-bottom: 2mm;
                text-align: justify;
            }
            
            .footer-info {
                display: flex;
                justify-content: space-between;
                align-items: center;
                font-size: 8pt;
            }
            
            .footer-left {
                font-weight: 600;
                color: #333;
            }
            
            .footer-right {
                text-align: right;
            }
            
            /* First Page Special */
            .hero-page .page-inner {
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
            
            .hero-content {
                text-align: center;
            }
            
            .hero-logo {
                height: 30mm;
                margin-bottom: 10mm;
            }
            
            /* Hero Page Premium Styling */
            .hero-title {
                font-size: 42pt;
                font-weight: 900;
                color: #cc0000;
                margin-bottom: 5mm;
                letter-spacing: -1.5px;
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            
            .hero-subtitle {
                font-size: 16pt;
                color: #444;
                margin-bottom: 15mm;
                font-weight: 300;
                letter-spacing: 0.5px;
            }
            
            .info-grid {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 5mm;
                margin: 10mm 0;
            }
            
            .info-card {
                background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
                padding: 6mm;
                border-radius: 3mm;
                text-align: center;
                box-shadow: 0 1mm 3mm rgba(0,0,0,0.05);
            }
            
            .info-label {
                font-size: 8pt;
                color: #666;
                text-transform: uppercase;
                letter-spacing: 0.8px;
                margin-bottom: 2mm;
                font-weight: 600;
            }
            
            .info-value {
                font-size: 12pt;
                font-weight: 800;
                color: #1a1a1a;
            }
            
            .address-section {
                background: linear-gradient(135deg, #006b6b 0%, #004d4d 100%);
                color: white;
                padding: 10mm;
                border-radius: 4mm;
                margin: 10mm 0;
                text-align: left;
                box-shadow: 0 2mm 5mm rgba(0,0,0,0.1);
            }
            
            .address-title {
                font-size: 16pt;
                font-weight: 800;
                margin-bottom: 4mm;
                letter-spacing: 0.5px;
            }
            
            .address-section div {
                line-height: 1.6;
                font-size: 11pt;
            }
            
            .collection-notice {
                background: linear-gradient(135deg, #fff8dc 0%, #ffedd5 100%);
                border-left: 5mm solid #ff6b35;
                padding: 6mm 8mm;
                margin: 10mm 0;
                font-size: 10pt;
                border-radius: 0 3mm 3mm 0;
                box-shadow: 0 1mm 3mm rgba(0,0,0,0.08);
            }
            
            .notice-title {
                font-weight: 800;
                margin-bottom: 2mm;
                color: #d84315;
                font-size: 11pt;
            }
        }
        
        @page {
            size: A4;
            margin: 0;
        }
        
        /* Screen Preview Styles */
        @media screen {
            .page {
                background: white;
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                margin-bottom: 20px;
                position: relative;
                width: 210mm;
                min-height: 297mm;
            }
            
            .page-inner {
                padding: 15mm;
            }
        }
    </style>
</head>
<body>
    <div class="control-panel">
        <div class="logo-header">
            <h1>OZZ Professional Catalog Generator</h1>
            <p>Create beautiful retail-quality promotional catalogs</p>
        </div>
        
        <div class="button-group">
            <button onclick="loadCatalog()" id="loadBtn">
                üìÅ Load JULY PROMO.xlsx
            </button>
            <button onclick="generateCatalog()" id="generateBtn" disabled>
                üìÑ Generate Catalog
            </button>
            <button onclick="window.print()" id="printBtn" disabled>
                üñ®Ô∏è Print / Save PDF
            </button>
        </div>
        
        <div class="status-box" id="status">
            Ready to load catalog data...
        </div>
        
        <div id="categorySection" class="category-section" style="display: none;">
            <h3>Select Categories to Include:</h3>
            <div id="categoryList" class="category-grid"></div>
        </div>
    </div>
    
    <div id="printContent" class="print-preview"></div>

    <script>
        let allProducts = [];
        let categories = [];
        let imageManager = null;
        
        // Simple image manager
        class ImageManager {
            constructor() {
                this.images = new Map();
            }
            
            getImageUrl(sku) {
                // Placeholder - returns null for now
                return null;
            }
        }
        
        async function loadCatalog() {
            const loadBtn = document.getElementById('loadBtn');
            const status = document.getElementById('status');
            
            loadBtn.disabled = true;
            status.innerHTML = '‚è≥ Loading Excel file...';
            
            try {
                const response = await fetch('./JULY PROMO.xlsx');
                if (!response.ok) {
                    throw new Error('Could not find JULY PROMO.xlsx in the same folder');
                }
                
                const data = await response.arrayBuffer();
                const workbook = XLSX.read(data);
                const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                const jsonData = XLSX.utils.sheet_to_json(worksheet);
                
                // Check what columns are available
                if (jsonData.length > 0) {
                    console.log('Available columns:', Object.keys(jsonData[0]));
                    console.log('First row sample:', jsonData[0]);
                }
                
                // Try multiple possible column names for flexibility
                allProducts = jsonData
                    .filter(row => {
                        // Check for SKU variations
                        const sku = row.SKU || row['Item Code'] || row['Product Code'] || row['Code'];
                        // Check for description variations
                        const desc = row['PRODUCT '] || row.PRODUCT || row.Description || row['Product Description'] || row.Name;
                        // Check for price variations
                        const price = row.PRICE || row.Price || row['Selling Price'] || row['Unit Price'];
                        // Check for category variations
                        const cat = row.CATEGORY || row.Category || row['Product Category'] || row.Type;
                        
                        return sku && desc && price !== undefined && cat;
                    })
                    .map(row => {
                        // Map with same flexibility
                        const sku = row.SKU || row['Item Code'] || row['Product Code'] || row['Code'];
                        const desc = row['PRODUCT '] || row.PRODUCT || row.Description || row['Product Description'] || row.Name;
                        const price = row.PRICE || row.Price || row['Selling Price'] || row['Unit Price'];
                        const cat = row.CATEGORY || row.Category || row['Product Category'] || row.Type;
                        
                        return {
                            sku: String(sku).trim(),
                            description: String(desc).trim(),
                            price: parseFloat(price) || 0,
                            category: String(cat).trim().toUpperCase()
                        };
                    })
                    .filter(p => p.price > 0);
                
                // If no products found, show what columns were detected
                if (allProducts.length === 0 && jsonData.length > 0) {
                    const cols = Object.keys(jsonData[0]).join(', ');
                    throw new Error(`No valid products found. Detected columns: ${cols}. Please ensure your Excel has columns for SKU, Product description, Price, and Category.`);
                }
                
                // Get categories
                categories = [...new Set(allProducts.map(p => p.category))].sort();
                
                // Initialize image manager
                imageManager = new ImageManager();
                
                // Show categories
                showCategories();
                
                document.getElementById('generateBtn').disabled = false;
                status.innerHTML = `‚úÖ <strong>Loaded ${allProducts.length} products in ${categories.length} categories</strong>`;
                
            } catch (error) {
                status.innerHTML = `‚ùå <strong style="color: #dc3545;">Error: ${error.message}</strong>`;
                console.error('Error details:', error);
            } finally {
                loadBtn.disabled = false;
            }
        }
        
        function showCategories() {
            const section = document.getElementById('categorySection');
            const list = document.getElementById('categoryList');
            
            section.style.display = 'block';
            list.innerHTML = '';
            
            categories.forEach(cat => {
                const count = allProducts.filter(p => p.category === cat).length;
                const item = document.createElement('label');
                item.className = 'category-item';
                item.innerHTML = `
                    <input type="checkbox" checked value="${cat}" class="category-cb">
                    <span>${cat}</span>
                    <span class="category-count">${count} items</span>
                `;
                list.appendChild(item);
            });
        }
        
        function generateCatalog() {
            const selectedCats = Array.from(document.querySelectorAll('.category-cb:checked'))
                .map(cb => cb.value);
            
            if (selectedCats.length === 0) {
                alert('Please select at least one category');
                return;
            }
            
            const filteredProducts = allProducts.filter(p => selectedCats.includes(p.category));
            
            // Sort by category then description
            filteredProducts.sort((a, b) => {
                if (a.category !== b.category) {
                    return a.category.localeCompare(b.category);
                }
                return a.description.localeCompare(b.description);
            });
            
            // Generate pages
            const printContent = document.getElementById('printContent');
            printContent.innerHTML = '';
            
            // Add header page
            printContent.appendChild(createHeaderPage());
            
            // Group by category
            const grouped = {};
            filteredProducts.forEach(p => {
                if (!grouped[p.category]) grouped[p.category] = [];
                grouped[p.category].push(p);
            });
            
            // Create product pages
            let pageNum = 2;
            Object.entries(grouped).forEach(([category, products]) => {
                // Each category starts on a new page
                for (let i = 0; i < products.length; i += 8) {
                    const pageProducts = products.slice(i, i + 8);
                    const showCategoryHeader = i === 0;
                    printContent.appendChild(createProductPage(pageProducts, category, showCategoryHeader, pageNum++));
                }
            });
            
            // Update page numbers
            const totalPages = printContent.querySelectorAll('.page').length;
            printContent.querySelectorAll('.total-pages').forEach(el => {
                el.textContent = totalPages;
            });
            
            document.getElementById('printBtn').disabled = false;
            document.getElementById('status').innerHTML = 
                `‚úÖ <strong>Generated ${totalPages} pages with ${filteredProducts.length} products</strong>`;
            
            // Scroll to preview
            printContent.scrollIntoView({ behavior: 'smooth' });
        }
        
        function createHeaderPage() {
            const page = document.createElement('div');
            page.className = 'page hero-page';
            
            page.innerHTML = `
                <div class="page-inner">
                    <div class="hero-content">
                        <img src="https://raw.githubusercontent.com/Iamabhih/OZZPromotions/main/OZZ-logo-transparent-1-1.png" 
                             alt="OZZ Cash & Carry" 
                             class="hero-logo"
                             onerror="this.style.display='none'">
                        
                        <h1 class="hero-title">JULY 2025 PROMO</h1>
                        <p class="hero-subtitle">Exclusive Deals on Premium Home & Kitchen Products</p>
                        
                        <div class="info-grid">
                            <div class="info-card">
                                <div class="info-label">Phone</div>
                                <div class="info-value">+27 31 332 7192</div>
                            </div>
                            <div class="info-card">
                                <div class="info-label">Email</div>
                                <div class="info-value">info@ozzsa.com</div>
                            </div>
                            <div class="info-card">
                                <div class="info-label">Website</div>
                                <div class="info-value">www.ozzsa.com</div>
                            </div>
                        </div>
                        
                        <div class="address-section">
                            <div class="address-title">OZZ CASH & CARRY</div>
                            <div>40 Mazeppa & Gull Street</div>
                            <div>Durban, KwaZulu-Natal 4001</div>
                            <div>South Africa</div>
                            <div style="margin-top: 3mm;">
                                <strong>Hours:</strong> Mon-Fri: 8AM-5PM | Sat: 8AM-1PM
                            </div>
                        </div>
                        
                        <div class="collection-notice">
                            <div class="notice-title">üìç COLLECTION & DELIVERY</div>
                            <div>Promotional prices are valid for collection only at 40 Mazeppa Street, Durban.</div>
                            <div>Delivery is available at an additional charge.</div>
                        </div>
                    </div>
                    
                    <div class="page-footer">
                        <div class="disclaimer">
                            While Ozz Cash and Carry will always attempt to have sufficient stock available, the above prices are valid till stocks last. 
                            Ozz Cash and Carry reserves the right to limit quantities. Errors and omissions excepted - Ozz Cash and Carry will always 
                            take utmost care to ensure that advertising information is correct, however should a mistake or inaccuracy occur, Ozz Cash 
                            and Carry shall display an in-store notice reflecting the correct details. All items include VAT where applicable. 
                            Images are for illustrative purposes only.
                        </div>
                        <div class="footer-info">
                            <span class="footer-left">OZZ Cash & Carry ‚Ä¢ July 2025 Catalog</span>
                            <span class="footer-right">Page 1 of <span class="total-pages">-</span> ‚Ä¢ Version 3.0</span>
                        </div>
                    </div>
                </div>
            `;
            
            return page;
        }
        
        function createProductPage(products, category, showHeader, pageNum) {
            const page = document.createElement('div');
            page.className = 'page';
            
            let contentHTML = `
                <div class="page-inner">
                    <div class="page-header">
                        <div class="header-left">
                            <img src="https://raw.githubusercontent.com/Iamabhih/OZZPromotions/main/OZZ-logo-transparent-1-1.png" 
                                 alt="OZZ" class="header-logo" onerror="this.style.display='none'">
                            <span class="header-title">July 2025 Promotional Catalog</span>
                        </div>
                        <span class="page-number">Page ${pageNum} of <span class="total-pages">-</span></span>
                    </div>
                    
                    <div class="page-content">
            `;
            
            if (showHeader) {
                contentHTML += `<div class="category-header">${category}</div>`;
            }
            
            contentHTML += '<div class="products-container"><div class="products-grid">';
            
            // Always create exactly 8 slots
            for (let i = 0; i < 8; i++) {
                if (i < products.length) {
                    contentHTML += createProductCard(products[i]);
                } else {
                    contentHTML += '<div class="product-card" style="visibility: hidden;"></div>';
                }
            }
            
            contentHTML += `
                        </div></div>
                    </div>
                    
                    <div class="page-footer">
                        <div class="disclaimer">
                            While Ozz Cash and Carry will always attempt to have sufficient stock available, the above prices are valid till stocks last. 
                            Ozz Cash and Carry reserves the right to limit quantities. Errors and omissions excepted - Ozz Cash and Carry will always 
                            take utmost care to ensure that advertising information is correct, however should a mistake or inaccuracy occur, Ozz Cash 
                            and Carry shall display an in-store notice reflecting the correct details. All items include VAT where applicable. 
                            Images are for illustrative purposes only.
                        </div>
                        <div class="footer-info">
                            <span class="footer-left">OZZ Cash & Carry ‚Ä¢ +27 31 332 7192 ‚Ä¢ info@ozzsa.com</span>
                            <span class="footer-right">www.ozzsa.com ‚Ä¢ Version 3.0</span>
                        </div>
                    </div>
                </div>
            `;
            
            page.innerHTML = contentHTML;
            return page;
        }
        
        function createProductCard(product) {
            const imageUrl = imageManager ? imageManager.getImageUrl(product.sku) : null;
            const originalPrice = (product.price * 1.2).toFixed(2);
            const savePercent = Math.round(((originalPrice - product.price) / originalPrice) * 100);
            
            // Split price into rands and cents
            const priceStr = product.price.toFixed(2);
            const [rands, cents] = priceStr.split('.');
            
            // Extract product name and variant from description
            const descWords = product.description.split(' ');
            let productName = '';
            let productVariant = '';
            
            // Simple logic to split name and variant
            if (descWords.length > 2) {
                productName = descWords.slice(0, 2).join(' ');
                productVariant = descWords.slice(2).join(' ');
            } else {
                productName = product.description;
                productVariant = product.category;
            }
            
            return `
                <div class="product-card">
                    <div class="product-image">
                        ${imageUrl ? 
                            `<img src="${imageUrl}" alt="${product.description}" onerror="this.parentElement.innerHTML='<div class=\\'no-image\\'><div class=\\'no-image-icon\\'>ü•É</div><div class=\\'no-image-text\\'>No Image</div></div>'">` :
                            `<div class="no-image">
                                <div class="no-image-icon">ü•É</div>
                                <div class="no-image-text">No Image</div>
                            </div>`
                        }
                    </div>
                    <div class="product-details">
                        <div class="product-header">
                            <div class="product-name">${productName}</div>
                            <div class="product-variant">${productVariant}</div>
                        </div>
                        <div class="product-specs">
                            <div class="spec-item">
                                <span class="spec-bullet">‚Ä¢</span>
                                <span class="spec-label">SKU:</span>
                                <span class="spec-value">${product.sku}</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-bullet">‚Ä¢</span>
                                <span class="spec-label">Category:</span>
                                <span class="spec-value">${product.category}</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-bullet">‚Ä¢</span>
                                <span class="spec-label">Price:</span>
                                <span class="spec-value">R${originalPrice} RRP</span>
                            </div>
                            ${savePercent > 0 ? `
                                <div class="spec-item">
                                    <span class="spec-bullet">‚Ä¢</span>
                                    <span class="spec-label">Savings:</span>
                                    <span class="spec-value">${savePercent}% OFF</span>
                                </div>
                            ` : ''}
                        </div>
                        <div class="price-badge">
                            <div class="price-amount">
                                <span class="price-currency">R</span>${rands}<span class="price-cents">${cents}</span>
                            </div>
                            <div class="price-unit">Each</div>
                        </div>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
